<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Structures and functions to perform constraint-based metabolic network analysis, e.g., the prediction of metabolic fluxes using Flux Balance Analysis (FBA).">
<title>Constraint-Based Metabolic Network Analysis in R • cobrar</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Constraint-Based Metabolic Network Analysis in R">
<meta property="og:description" content="Structures and functions to perform constraint-based metabolic network analysis, e.g., the prediction of metabolic fluxes using Flux Balance Analysis (FBA).">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">cobrar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/1_FVA.html">Flux Variability Analysis (FVA)</a>
    <a class="dropdown-item" href="articles/2_additional_constraints.html">Additional constraints</a>
    <a class="dropdown-item" href="articles/3_Community-models.html">Community models</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Waschina/cobrar/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.svg" class="logo" alt=""><h1 id="cobrar-">cobrar <a class="anchor" aria-label="anchor" href="#cobrar-"></a>
</h1>
</div>
<!-- badges: start -->

<p>The R package <em>cobrar</em> provides structures and functions for constraint-based metabolic network analysis, e.g. the prediction of metabolic fluxes using fluxes using Flux Balance Analysis (FBA). <em>cobrar</em> is inspired by the former CRAN R package <em>sybil</em><a href="#R1">(1)</a>.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Please note that <em>cobrar</em> requires the two system libraries <em>libSBML</em> and <em>glpk</em>. The following installation instructions for different operating systems install the dependencies first, then <em>cobrar</em>. If you already have <em>libSBML</em> and <em>glpk</em> installed, you can skip to the last part of the instructions.</p>
<p><em>cobrar</em> is under development and the installation instructions described will install the latest development version.</p>
<div class="section level4">
<h4 id="ubuntudebianmint">Ubuntu/Debian/Mint<a class="anchor" aria-label="anchor" href="#ubuntudebianmint"></a>
</h4>
<p>Install <em>libSBML</em> and <em>glpk</em>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">sudo</span> apt install libsbml-dev libglpk-dev</span></code></pre></div>
<p>Install cobrar (in <em>R</em>):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"Waschina/cobrar"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="centosfedorarhel">Centos/Fedora/RHEL<a class="anchor" aria-label="anchor" href="#centosfedorarhel"></a>
</h4>
<p>Install <em>libSBML</em> and <em>glpk</em>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">sudo</span> yum install libsbml-devel glpk-devel</span></code></pre></div>
<p>Install cobrar (in <em>R</em>):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"Waschina/cobrar"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="macos">MacOS<a class="anchor" aria-label="anchor" href="#macos"></a>
</h4>
<p><em>libSBML</em> and <em>glpk</em> can be installed using homebrew:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">brew</span> install glpk brewsci/bio/libsbml</span></code></pre></div>
<p>Install cobrar (in <em>R</em>):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"Waschina/cobrar"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="windows">Windows<a class="anchor" aria-label="anchor" href="#windows"></a>
</h4>
<p>TODO</p>
</div>
<div class="section level4">
<h4 id="conda">Conda<a class="anchor" aria-label="anchor" href="#conda"></a>
</h4>
<p>TODO</p>
</div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>The full documentation including illustrative examples is available <a href="https://waschina.github.io/cobrar/" class="external-link">here</a>.</p>
<p>The following (very brief) example illustrates how to use <code>cobrar</code> to perform flux balance analysis for a core metabolism model of <em>Escherichia coli</em>. In a first simulation, fluxes and growth are predicted for the default constraints of the model, which represents a minimal medium with glucose as the sole carbon source and the presence of oxygen. The second simulation performs the same flux balance analysis but without oxygen to simulate an anoxic growth environment.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First, load the cobrar package and the metabolic model:</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Waschina/cobrar" class="external-link">cobrar</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span><span class="co">#&gt; cobrar uses...</span></span>
<span><span class="co">#&gt;  - libSBML (v. 5.18.0)</span></span>
<span><span class="co">#&gt;  - glpk (v. 4.65)</span></span>
<span><span class="va">fpath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"e_coli_core.xml"</span>, package<span class="op">=</span><span class="st">"cobrar"</span><span class="op">)</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/readSBMLmod.html">readSBMLmod</a></span><span class="op">(</span><span class="va">fpath</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Next, perform simulation 1: Aerobic growth of E. coli</span></span>
<span><span class="va">res_aero</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fba.html">fba</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Finally, simulation 2: Anaerobic growth of E. coli</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/changeBounds.html">changeBounds</a></span><span class="op">(</span><span class="va">mod</span>, react <span class="op">=</span> <span class="st">"EX_o2_e"</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># before: -1000</span></span>
<span><span class="va">res_anaero</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fba.html">fba</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Report simulation results (i.e., growth and acetate production)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"[Aerobic growth]\n"</span>,</span>
<span>    <span class="st">" Growth rate:        "</span>, <span class="va">res_aero</span><span class="op">@</span><span class="va">obj</span>,<span class="st">"\n"</span>,</span>
<span>    <span class="st">" Acetate production: "</span>, <span class="va">res_aero</span><span class="op">@</span><span class="va">fluxes</span><span class="op">[</span><span class="va">mod</span><span class="op">@</span><span class="va">react_id</span> <span class="op">==</span> <span class="st">"EX_ac_e"</span><span class="op">]</span>,<span class="st">"\n\n"</span>,</span>
<span>    <span class="st">"[Anaerobic growth]\n"</span>,</span>
<span>    <span class="st">" Growth rate:        "</span>, <span class="va">res_anaero</span><span class="op">@</span><span class="va">obj</span>,<span class="st">"\n"</span>,</span>
<span>    <span class="st">" Acetate prodcution: "</span>, <span class="va">res_anaero</span><span class="op">@</span><span class="va">fluxes</span><span class="op">[</span><span class="va">mod</span><span class="op">@</span><span class="va">react_id</span> <span class="op">==</span> <span class="st">"EX_ac_e"</span><span class="op">]</span>,<span class="st">"\n"</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="co">#&gt; [Aerobic growth]</span></span>
<span><span class="co">#&gt;  Growth rate:        0.8739215</span></span>
<span><span class="co">#&gt;  Acetate production: 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [Anaerobic growth]</span></span>
<span><span class="co">#&gt;  Growth rate:        0.2116629</span></span>
<span><span class="co">#&gt;  Acetate prodcution: 8.503585</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="key-differences-to-sybil">Key differences to sybil<a class="anchor" aria-label="anchor" href="#key-differences-to-sybil"></a>
</h2>
<ul>
<li>cobrar is fully functional from reading SBML files until optimisation of linear programs, without the need of additional packages such as <em>sybilSBML</em> or <em>glpkAPI</em>.</li>
<li>cobrar links to libsbml via libsbml’s C++ API, not the C API as the <em>sybilSBML</em> package.</li>
<li>The GNU glpk library is a system requirement. There are no links/references to IBM’s CPLEX in the <em>cobrar</em> package, which were one reason why <em>sybil</em> was discontinued on CRAN.</li>
<li>
<a href="https://roxygen2.r-lib.org/" class="external-link">roxygen2</a> is used for documenting functions and classes.</li>
<li>Feature trim: A range of functions in <em>sybil</em> are not part of <em>cobrar</em>.</li>
<li>In <em>cobrar</em>, R’s garbage collector handles memory management, including memory associated to C++-objects and the pointers to these.</li>
<li>Simplifications in class and function architecture
<ul>
<li>No more Class “SysBiolAlg” nor sub-classes. Different algorithms have their own function and detailed documentation of their return values</li>
</ul>
</li>
<li>In <em>sybil</em>, columns named “annotation” were actually concatenated CVTerms (<a href="https://synonym.caltech.edu/software/libsbml/5.20.0/cpp-api/class_c_v_term.html" class="external-link uri">https://synonym.caltech.edu/software/libsbml/5.20.0/cpp-api/class_c_v_term.html</a>). To avoid confusion with other levels of annotation, the columns (e.g. in <code>react_attr</code> or <code>met_attr</code>) are named ‘CVTerms’ in <em>cobrar</em>.</li>
<li>
<em>cobrar</em> allows to assign SBOTerms to reactions, metabolites, genes.</li>
<li>Performance (i.e., computation time) improvements in certain procedures:
<ul>
<li>identification of dead-end metabolites</li>
<li>reading/exporting SBML files,</li>
<li>pFBA algorithm (a.k.a MTF ‘Minimization of Total Flux’).</li>
<li>FVA; also now allows relaxed constraints on optimal growth (e.g. flux variability with 90-100% optimal growth)</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h2>
<ul>
<li>
<em>cobrar</em> exports SBML files level 3 version 2 with <code>fbc</code> version 3 and <code>groups</code> version 1.</li>
<li>Group assignments are only supported for reactions.</li>
<li>currently only glpk is supported as solver. A plugin for IBM’s ILOG CPLEX is planned.</li>
<li>
<em>Multiple objectives</em>. The SBML standard with its <code>fbc</code> extension allows to specify more than one objective (class <code>ListOfObjectives</code>). However, <em>cobrar</em> can only handle one current objective function per model, which is defined as an objective coefficient vector in slot <code>obj_coef</code> of an object of class <code>modelorg</code>. Note that when reading SBML models, <em>cobrar</em> will only use the first objective defined in the SBML document.</li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ol style="list-style-type: decimal">
<li>
<a id="R1"></a>Gelius-Dietrich, G., Desouki, A.A., Fritzemeier, C.J., Lercher, M.J. sybil – Efficient constraint-based modelling in R. BMC Syst Biol 7, 125 (2013). <a href="https://doi.org/10.1186/1752-0509-7-125" class="external-link uri">https://doi.org/10.1186/1752-0509-7-125</a>
</li>
</ol>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/Waschina/cobrar/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing cobrar</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Silvio Waschina <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-6290-3593" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Johannes Zimmermann <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-5041-1954" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Sina Zimmermann <br><small class="roles"> Author </small> <a href="https://orcid.org/0009-0005-0537-4970" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/Waschina/cobrar/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/Waschina/cobrar/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Silvio Waschina, Johannes Zimmermann, Sina Zimmermann.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
