<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Add or modify a reaction — addReact • cobrar</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add or modify a reaction — addReact"><meta name="description" content="The function can be used to add or modify a reaction in an existing model."><meta property="og:description" content="The function can be used to add or modify a reaction in an existing model."><meta property="og:image" content="/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cobrar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/cobrar.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/FVA.html">Flux Variability Analysis (FVA)</a></li>
    <li><a class="dropdown-item" href="../articles/Additional_constraints.html">Additional constraints</a></li>
    <li><a class="dropdown-item" href="../articles/Community_models.html">Community models</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Waschina/cobrar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Add or modify a reaction</h1>
      <small class="dont-index">Source: <a href="https://github.com/Waschina/cobrar/blob/v0.2.0/R/model_modifications.R" class="external-link"><code>R/model_modifications.R</code></a></small>
      <div class="d-none name"><code>addReact.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function can be used to add or modify a reaction in an existing model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">addReact</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  <span class="va">id</span>,</span>
<span>  <span class="va">met</span>,</span>
<span>  <span class="va">Scoef</span>,</span>
<span>  reversible <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  lb <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  ub <span class="op">=</span> <span class="fu"><a href="COBRAR_SETTINGS.html">COBRAR_SETTINGS</a></span><span class="op">(</span><span class="st">"MAXIMUM"</span><span class="op">)</span>,</span>
<span>  obj <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  subsystem <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  subsystemName <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  gprAssoc <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  reactName <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  metName <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  metComp <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  metCharge <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  metChemicalFormula <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  CVTerms <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  SBOTerm <span class="op">=</span> <span class="st">"guess"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>Model of class <a href="ModelOrg-class.html">ModelOrg</a></p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>Character for the reaction ID</p></dd>


<dt id="arg-met">met<a class="anchor" aria-label="anchor" href="#arg-met"></a></dt>
<dd><p>Character vector providing the IDs of metabolites that participate
in the reaction</p></dd>


<dt id="arg-scoef">Scoef<a class="anchor" aria-label="anchor" href="#arg-scoef"></a></dt>
<dd><p>Numeric vector (same length as <code>met</code>) of stoichiometric
coefficients for the metabolites in <code>met</code>. The value in <code>Scoef[i]</code> is the
stoichiometric coefficient of the metabolite in <code>met[i]</code>.</p></dd>


<dt id="arg-reversible">reversible<a class="anchor" aria-label="anchor" href="#arg-reversible"></a></dt>
<dd><p>This option has now effect and is only here for legacy
reasons. Whether a reaction is reversible or not is inferred by cobrar based
on the lower and upper bounds.</p></dd>


<dt id="arg-lb-ub">lb, ub<a class="anchor" aria-label="anchor" href="#arg-lb-ub"></a></dt>
<dd><p>Single numeric values that define the lower and upper flux
limits, respectively.</p></dd>


<dt id="arg-obj">obj<a class="anchor" aria-label="anchor" href="#arg-obj"></a></dt>
<dd><p>Single numeric value for the coefficient of the reaction in the
objective function.</p></dd>


<dt id="arg-subsystem">subsystem<a class="anchor" aria-label="anchor" href="#arg-subsystem"></a></dt>
<dd><p>A vector of character strings containing the sub system IDs
to which the reaction belongs.</p></dd>


<dt id="arg-subsystemname">subsystemName<a class="anchor" aria-label="anchor" href="#arg-subsystemname"></a></dt>
<dd><p>A character vector (same length as <code>subsystem</code>) for the
names of the subsystems. If the subsystem is already part of the model and
you do not want to change its name, just use NA the corresponding entry.</p></dd>


<dt id="arg-gprassoc">gprAssoc<a class="anchor" aria-label="anchor" href="#arg-gprassoc"></a></dt>
<dd><p>A single character string giving the Gene-Product-Reaction
(GPR) association for the reaction. If NA, no GRP association is created.</p></dd>


<dt id="arg-reactname">reactName<a class="anchor" aria-label="anchor" href="#arg-reactname"></a></dt>
<dd><p>A single character string giving the name for the reaction.
If NA, the value of argument <code>id</code> is used.</p></dd>


<dt id="arg-metname">metName<a class="anchor" aria-label="anchor" href="#arg-metname"></a></dt>
<dd><p>A vector of character strings of the same length as <code>met</code>
containing the metabolites names for the metabolites given in argument <code>met</code>.</p></dd>


<dt id="arg-metcomp">metComp<a class="anchor" aria-label="anchor" href="#arg-metcomp"></a></dt>
<dd><p>A vector of character strings of the same length as <code>met</code>
specifying the compartment IDs for the metabolites given in argument <code>met</code>.</p></dd>


<dt id="arg-metcharge">metCharge<a class="anchor" aria-label="anchor" href="#arg-metcharge"></a></dt>
<dd><p>A numeric vector of the same length as <code>met</code> defining the
charges for the metabolites given in argument <code>met</code>.</p></dd>


<dt id="arg-metchemicalformula">metChemicalFormula<a class="anchor" aria-label="anchor" href="#arg-metchemicalformula"></a></dt>
<dd><p>A character vector of the same length as <code>met</code>
defining the chemical formulas for the metabolites given in argument <code>met</code>.</p></dd>


<dt id="arg-cvterms">CVTerms<a class="anchor" aria-label="anchor" href="#arg-cvterms"></a></dt>
<dd><p>Cross-references to other resources.</p></dd>


<dt id="arg-sboterm">SBOTerm<a class="anchor" aria-label="anchor" href="#arg-sboterm"></a></dt>
<dd><p>A term ID from the Systems Biology Ontology. If 'guess', the
SBO will be inferred from the reaction details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If you want to use the function to update data of a pre-existing reaction but
not its stoichiometry, use NA for the parameters 'met' and 'Scoeff'.
If the reaction is already part of the model, any reaction value (e.g., lb,
ub, reactName), that is set to NA has the effect that the old value will be
used.
If the reaction is already part of the model, and values for the parameter
<code>subsystem</code> are provided, all previous set subsystem associations of the
reaction will be removed.
If metabolites or subsystems are not part of the model yet, they will be
added.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># This example adds the 4-aminobutyrate degradation pathway to the E. coli</span></span></span>
<span class="r-in"><span><span class="co"># core metabolic model</span></span></span>
<span class="r-in"><span><span class="va">fpath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"e_coli_core.xml"</span>, package<span class="op">=</span><span class="st">"cobrar"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="readSBMLmod.html">readSBMLmod</a></span><span class="op">(</span><span class="va">fpath</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="fba.html">fba</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Algorithm:              FBA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Solver status:          solution is optimal </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimization status:    optimization process was successful </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Objective fct. value:   0.8739215 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Secondary objective:    NA </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 4abut transport: 4abut_e + h_e &lt;=&gt; 4abut_c + h_c</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">addReact</span><span class="op">(</span><span class="va">mod</span>, id <span class="op">=</span> <span class="st">"ABUTt"</span>, Scoef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                met <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"4abut_e"</span>,<span class="st">"h_e"</span>,<span class="st">"4abut_c"</span>,<span class="st">"h_c"</span><span class="op">)</span>, reversible <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                lb <span class="op">=</span> <span class="op">-</span><span class="fl">1000</span>, ub <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>                reactName <span class="op">=</span> <span class="st">"4-aminobutyrate transport in via proton symport"</span>,</span></span>
<span class="r-in"><span>                metName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"4-aminobutyrate"</span>,<span class="cn">NA</span>, <span class="st">"4-aminobutyrate"</span>,<span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                metComp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"e"</span>,<span class="st">"e"</span>,<span class="st">"c"</span>,<span class="st">"c"</span><span class="op">)</span>, metCharge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span>,<span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                metChemicalFormula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C4H9NO2"</span>,<span class="cn">NA</span>,<span class="st">"C4H9NO2"</span>,<span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># exchange reaction for 4abut (with 1.5 mmol/gDW/hr availability)</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">addReact</span><span class="op">(</span><span class="va">mod</span>, id <span class="op">=</span> <span class="st">"EX_4abut_e"</span>, Scoef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, met <span class="op">=</span> <span class="st">"4abut_e"</span>,</span></span>
<span class="r-in"><span>                lb <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span>, ub <span class="op">=</span> <span class="fl">1000</span>, reactName <span class="op">=</span> <span class="st">"4-aminobutyrate exchange"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 4abut amninotransferase (EC 2.6.1.19)</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">addReact</span><span class="op">(</span><span class="va">mod</span>, id <span class="op">=</span> <span class="st">"ABTA"</span>, Scoef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                met <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"4abut_c"</span>,<span class="st">"akg_c"</span>,<span class="st">"glu__L_c"</span>,<span class="st">"sucsal_c"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                lb <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                reactName <span class="op">=</span> <span class="st">"4-aminobutyrate transaminase"</span>,</span></span>
<span class="r-in"><span>                metName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="st">"Succinic semialdehyde"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                metComp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="st">"c"</span><span class="op">)</span>, metCharge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                metChemicalFormula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="st">"C4H5O3"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                subsystem <span class="op">=</span> <span class="st">"GABAdegr"</span>, subsystemName <span class="op">=</span> <span class="st">"4-aminobutyrate degradation"</span>,</span></span>
<span class="r-in"><span>                CVTerms <span class="op">=</span> <span class="st">"bqbiol_is;http://identifiers.org/ec-code/2.6.1.19"</span>,</span></span>
<span class="r-in"><span>                gprAssoc <span class="op">=</span> <span class="st">"b2662 | b1302"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Succinate-semialdehyde dehydrogenase (NAD) (EC 1.2.1.24)</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">addReact</span><span class="op">(</span><span class="va">mod</span>, id <span class="op">=</span> <span class="st">"SSALx"</span>, Scoef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                met <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"h2o_c"</span>,<span class="st">"nad_c"</span>,<span class="st">"sucsal_c"</span>,<span class="st">"h_c"</span>,<span class="st">"nadh_c"</span>,<span class="st">"succ_c"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                lb <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                reactName <span class="op">=</span> <span class="st">"Succinate-semialdehyde dehydrogenase (NAD)"</span>,</span></span>
<span class="r-in"><span>                subsystem <span class="op">=</span> <span class="st">"GABAdegr"</span>,</span></span>
<span class="r-in"><span>                CVTerms <span class="op">=</span> <span class="st">"bqbiol_is;http://identifiers.org/ec-code/1.2.1.24"</span>,</span></span>
<span class="r-in"><span>                gprAssoc <span class="op">=</span> <span class="st">"b1525"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="printReaction.html">printReaction</a></span><span class="op">(</span><span class="va">mod</span>, <span class="st">"SSALx"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "(1) H2O + (1) NAD + (1) Succinic semialdehyde --&gt; (2) H+ + (1) NADH + (1) Succinate"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="fba.html">fba</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Algorithm:              FBA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Solver status:          solution is optimal </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimization status:    optimization process was successful </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Objective fct. value:   0.9674959 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Secondary objective:    NA </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Silvio Waschina, Johannes Zimmermann, Sina Zimmermann.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

