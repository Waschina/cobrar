---
title: "Flux Variability Analysis"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Flux Variability Analysis}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(cobrar)
library(ggplot2)
```

```{r}
fpath <- system.file("extdata", "e_coli_core.xml", package="cobrar")
mod <- readSBMLmod(fpath)

fvares <- fva(mod, react = mod@react_id[grepl("^EX_",mod@react_id)],
              opt.factor = seq(0.8, 1, length.out = 31))


ggplot(fvares,
       aes(x = react)) +
  geom_linerange(aes(ymin = min.flux, ymax = max.flux, col = growth.fraction),
                 linewidth = 10)
```
